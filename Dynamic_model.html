<html>
<head>
<title>Dynamic_model.thy</title>
</head>
<body bgcolor="#ffffff">



<pre><font color="#000000"><span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   1 </font></span><font color="#006699"><strong>theory</strong></font> Dynamic_model
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   2 </font></span><font color="#009966"><strong>imports</strong></font> Main
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   3 </font></span><font color="#009966"><strong>begin</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   4 </font></span><font color="#006699"><strong>subsection</strong></font> <font color="#6600cc">{* Security State Machine *}</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">   5 </font></span><font color="#006699"><strong>locale</strong></font> SM <font color="#000000"><strong>=</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   6 </font></span>  <font color="#009966"><strong>fixes</strong></font> s0 <font color="#000000"><strong>::</strong></font> 's
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   7 </font></span>  <font color="#009966"><strong>fixes</strong></font> step <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'s &rArr; 'e &rArr; 's&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   8 </font></span>  <font color="#009966"><strong>fixes</strong></font> domain <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'e &rArr; ('d option)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">   9 </font></span>  <font color="#009966"><strong>fixes</strong></font> vpeq <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'s &rArr; 'd &rArr; 's &rArr; bool&quot;</font>  <font color="#000000"><strong>(</strong></font><font color="#ff00cc">&quot;(_ &sim; _ &sim; _)&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  10 </font></span>  <font color="#009966"><strong>fixes</strong></font> interferes <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'d &rArr; 's &rArr; 'd &rArr; bool&quot;</font> <font color="#000000"><strong>(</strong></font><font color="#ff00cc">&quot;(_ @ _ &#8605;_)&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  11 </font></span>  <font color="#009966"><strong>assumes</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  12 </font></span>    vpeq_transitive_lemma <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall; s t r d. (s &sim; d &sim; t) &and; (t &sim; d &sim; r) &#10230; (s &sim; d &sim; r)&quot;</font> <font color="#009966"><strong>and</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  13 </font></span>    vpeq_symmetric_lemma <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall; s t d. (s &sim; d &sim; t) &#10230; (t &sim; d &sim; s)&quot;</font> <font color="#009966"><strong>and</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  14 </font></span>    vpeq_reflexive_lemma <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall; s d. (s &sim; d &sim; s)&quot;</font> <font color="#009966"><strong>and</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  15 </font></span>    interf_reflexive<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;d s. (d @ s &#8605; d)&quot;</font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  16 </font></span><font color="#009966"><strong>begin</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  17 </font></span>   
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  18 </font></span>    <font color="#006699"><strong>definition</strong></font> non_interferes <font color="#000000"><strong>::</strong></font>  <font color="#ff00cc">&quot;'d &rArr; 's &rArr; 'd &rArr; bool&quot;</font> <font color="#000000"><strong>(</strong></font><font color="#ff00cc">&quot;(_ @ _ &#8726;&#8605; _)&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  19 </font></span>      <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;(u @ s &#8726;&#8605; v) &equiv; (u @ s &#8605; v)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  20 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  21 </font></span>    <font color="#006699"><strong>definition</strong></font> ivpeq <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'s &rArr; 'd set &rArr; 's &rArr; bool&quot;</font> <font color="#000000"><strong>(</strong></font><font color="#ff00cc">&quot;(_ &asymp; _ &asymp; _)&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  22 </font></span>      <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;ivpeq s D t &equiv; &forall; d &isin; D. (s &sim; d &sim; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  23 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  24 </font></span>    <font color="#006699"><strong>primrec</strong></font> run <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'s &rArr; 'e list &rArr; 's&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  25 </font></span>      <font color="#009966"><strong>where</strong></font> run_Nil<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;run s [] = s&quot;</font> <font color="#000000"><strong>|</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  26 </font></span>            run_Cons<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;run s (a#as) = run (step s a) as &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  27 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  28 </font></span>    <font color="#006699"><strong>definition</strong></font> reachable <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'s &rArr; 's &rArr; bool&quot;</font> <font color="#000000"><strong>(</strong></font><font color="#ff00cc">&quot;(_ &#8618; _)&quot;</font> <font color="#000000"><strong>[</strong></font>70<font color="#000000"><strong>,</strong></font>71<font color="#000000"><strong>]</strong></font> 60<font color="#000000"><strong>)</strong></font> <font color="#009966"><strong>where</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  29 </font></span>      <font color="#ff00cc">&quot;reachable s1 s2 &equiv;  (&exist;as. run s1 as = s2 )&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  30 </font></span>    
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  31 </font></span>    <font color="#006699"><strong>definition</strong></font> reachable0 <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'s &rArr; bool&quot;</font>  <font color="#009966"><strong>where</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  32 </font></span>      <font color="#ff00cc">&quot;reachable0 s &equiv; reachable s0 s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  33 </font></span>      
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  34 </font></span>    <font color="#006699"><strong>declare</strong></font> non_interferes_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> ivpeq_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> reachable_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  35 </font></span>            <font color="#009966"><strong>and</strong></font> reachable0_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> run.simps<font color="#000000"><strong>(</strong></font>1<font color="#000000"><strong>)</strong></font><font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> run.simps<font color="#000000"><strong>(</strong></font>2<font color="#000000"><strong>)</strong></font><font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  36 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  37 </font></span>    <font color="#006699"><strong>lemma</strong></font> reachable_s0 <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s0&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  38 </font></span>      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis SM.reachable_def SM_axioms reachable0_def run.simps<font color="#000000"><strong>(</strong></font>1<font color="#000000"><strong>)</strong></font><font color="#000000"><strong>)</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  39 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  40 </font></span>    
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  41 </font></span>    <font color="#006699"><strong>lemma</strong></font> reachable_self <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable s s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  42 </font></span>      <font color="#006699"><strong>using</strong></font> reachable_def run.simps<font color="#000000"><strong>(</strong></font>1<font color="#000000"><strong>)</strong></font> <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  43 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  44 </font></span>    <font color="#006699"><strong>lemma</strong></font> reachable_step <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s' = step s a &#10233; reachable s s'&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  45 </font></span>      <font color="#006699"><strong>proof</strong></font>-
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  46 </font></span>        <font color="#0099ff"><strong>assume</strong></font> a0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s' = step s a&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  47 </font></span>        <font color="#006699"><strong>then</strong></font> <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;s' = run s [a]&quot;</font> <font color="#006699"><strong>by</strong></font> auto          
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  48 </font></span>        <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>using</strong></font> reachable_def <font color="#006699"><strong>by</strong></font> blast 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  49 </font></span>      <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  50 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  51 </font></span>    <font color="#006699"><strong>lemma</strong></font> run_trans <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;C T V as bs. T = run C as &and; V = run T bs &#10230; V = run C (as@bs)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  52 </font></span>     <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  53 </font></span>      <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  54 </font></span>        <font color="#0099ff"><strong>fix</strong></font> T V as bs
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  55 </font></span>        <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;&forall;C. T = run C as &and; V = run T bs &#10230; V = run C (as@bs)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  56 </font></span>          <font color="#006699"><strong>proof</strong></font><font color="#000000"><strong>(</strong></font>induct as<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  57 </font></span>            <font color="#0099ff"><strong>case</strong></font> Nil <font color="#0099ff"><strong>show</strong></font> ?case <font color="#006699"><strong>by</strong></font> simp
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  58 </font></span>          <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  59 </font></span>            <font color="#0099ff"><strong>case</strong></font> <font color="#000000"><strong>(</strong></font>Cons c cs<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  60 </font></span>            <font color="#0099ff"><strong>assume</strong></font> a0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;C. T = run C cs &and; V = run T bs &#10230; V = run C (cs @ bs)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  61 </font></span>            <font color="#0099ff"><strong>show</strong></font> ?case
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  62 </font></span>              <font color="#006699"><strong>proof</strong></font>-
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  63 </font></span>              <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  64 </font></span>                <font color="#0099ff"><strong>fix</strong></font> C
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  65 </font></span>                <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;T = run C (c # cs) &and; V = run T bs &#10230; V = run C ((c # cs) @ bs) &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  66 </font></span>                  <font color="#006699"><strong>proof</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  67 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;T = run C (c # cs) &and; V = run T bs&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  68 </font></span>                    <font color="#006699"><strong>from</strong></font> b0 <font color="#0099ff"><strong>obtain</strong></font> C' <font color="#009966"><strong>where</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;C' = step C c &and; T = run C' cs&quot;</font> <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  69 </font></span>                    <font color="#006699"><strong>with</strong></font> a0 b0 <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;V = run C' (cs@bs)&quot;</font> <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  70 </font></span>                    <font color="#006699"><strong>with</strong></font> b2 <font color="#0099ff"><strong>show</strong></font> <font color="#ff00cc">&quot;V = run C ((c # cs) @ bs)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  71 </font></span>                      <font color="#006699"><strong>using</strong></font> append_Cons run_Cons <font color="#006699"><strong>by</strong></font> auto 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  72 </font></span>                  <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  73 </font></span>              <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  74 </font></span>              <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  75 </font></span>              <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  76 </font></span>          <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  77 </font></span>      <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  78 </font></span>      <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  79 </font></span>      <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  80 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  81 </font></span>    <font color="#006699"><strong>lemma</strong></font> reachable_trans <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;reachable C T; reachable T V&#10215; &#10233; reachable C V&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  82 </font></span>      <font color="#006699"><strong>proof</strong></font>-
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  83 </font></span>        <font color="#0099ff"><strong>assume</strong></font> a0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable C T&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  84 </font></span>        <font color="#0099ff"><strong>assume</strong></font> a1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable T V&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  85 </font></span>        <font color="#006699"><strong>from</strong></font> a0 <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;C = T &or; (&exist;as. T = run C as)&quot;</font> <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  86 </font></span>        <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  87 </font></span>          <font color="#006699"><strong>proof</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  88 </font></span>            <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;C = T&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  89 </font></span>            <font color="#0099ff"><strong>show</strong></font> ?thesis 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  90 </font></span>              <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  91 </font></span>                <font color="#006699"><strong>from</strong></font> a1 <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;T = V &or; (&exist;as. V = run T as)&quot;</font> <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  92 </font></span>                <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  93 </font></span>                  <font color="#006699"><strong>proof</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  94 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> c0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;T=V&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066">  95 </font></span>                    <font color="#006699"><strong>with</strong></font> a0 <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  96 </font></span>                  <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  97 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> c0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(&exist;as. V = run T as)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  98 </font></span>                    <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>using</strong></font> a1 b0 <font color="#006699"><strong>by</strong></font> auto 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000">  99 </font></span>                  <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 100 </font></span>              <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 101 </font></span>          <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 102 </font></span>            <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&exist;as. T = run C as&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 103 </font></span>            <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 104 </font></span>              <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 105 </font></span>                <font color="#006699"><strong>from</strong></font> a1 <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;T = V &or; (&exist;as. V = run T as)&quot;</font> <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 106 </font></span>                <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 107 </font></span>                  <font color="#006699"><strong>proof</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 108 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> c0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;T=V&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 109 </font></span>                    <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>using</strong></font> a0 <font color="#006699"><strong>by</strong></font> auto 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 110 </font></span>                  <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 111 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> c0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(&exist;as. V = run T as)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 112 </font></span>                    <font color="#006699"><strong>from</strong></font> b0 <font color="#0099ff"><strong>obtain</strong></font> as <font color="#009966"><strong>where</strong></font> d0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;T = run C as&quot;</font> <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 113 </font></span>                    <font color="#006699"><strong>from</strong></font> c0 <font color="#0099ff"><strong>obtain</strong></font> bs <font color="#009966"><strong>where</strong></font> d1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;V = run T bs&quot;</font> <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 114 </font></span>                    <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>using</strong></font> d0  run_trans <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 115 </font></span>                  <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 116 </font></span>              <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 117 </font></span>          <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 118 </font></span>      <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 119 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 120 </font></span>    <font color="#006699"><strong>lemma</strong></font> reachableStep <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;reachable0 C; C' = step C a&#10215; &#10233; reachable0 C'&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 121 </font></span>      <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> reachable0_def<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 122 </font></span>      <font color="#006699"><strong>using</strong></font> reachable_step reachable_trans <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 123 </font></span>    
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 124 </font></span>    <font color="#006699"><strong>lemma</strong></font> reachable0_reach <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;reachable0 C; reachable C C'&#10215; &#10233; reachable0 C'&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 125 </font></span>      <font color="#006699"><strong>using</strong></font>  reachable_trans <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 126 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 127 </font></span>    <font color="#006699"><strong>declare</strong></font> reachable_def<font color="#000000"><strong>[</strong></font>cong del<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> reachable0_def<font color="#000000"><strong>[</strong></font>cong del<font color="#000000"><strong>]</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 128 </font></span><font color="#009966"><strong>end</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 129 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 130 </font></span><font color="#006699"><strong>subsection</strong></font><font color="#6600cc">{* Information flow security properties *}</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 131 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 132 </font></span><font color="#006699"><strong>locale</strong></font> SM_enabled <font color="#000000"><strong>=</strong></font> SM s0 step domain vpeq interferes
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 133 </font></span>  <font color="#009966"><strong>for</strong></font> s0 <font color="#000000"><strong>::</strong></font> 's <font color="#009966"><strong>and</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 134 </font></span>       step <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'s &rArr; 'e &rArr; 's&quot;</font> <font color="#009966"><strong>and</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 135 </font></span>       domain <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'e &rArr; ('d option)&quot;</font> <font color="#009966"><strong>and</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 136 </font></span>       vpeq <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'s &rArr; 'd &rArr; 's &rArr; bool&quot;</font>  <font color="#000000"><strong>(</strong></font><font color="#ff00cc">&quot;(_ &sim; _ &sim; _)&quot;</font><font color="#000000"><strong>)</strong></font> <font color="#009966"><strong>and</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 137 </font></span>       interferes <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'d &rArr; 's &rArr; 'd &rArr; bool&quot;</font> <font color="#000000"><strong>(</strong></font><font color="#ff00cc">&quot;(_ @ _ &#8605;_)&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 138 </font></span>  <font color="#000000"><strong>+</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 139 </font></span>  <font color="#009966"><strong>assumes</strong></font> enabled0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;s a. reachable0 s &#10230; (&exist; s'. s' = step s a)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 140 </font></span>    <font color="#009966"><strong>and</strong></font>   policy_respect<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v u s t. (s &sim; u &sim; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 141 </font></span><font color="#ff00cc">                              &#10230; (interferes v s u = interferes v t u)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 142 </font></span><font color="#009966"><strong>begin</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 143 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 144 </font></span>    <font color="#006699"><strong>lemma</strong></font> enabled <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s &#10233; (&exist; s'. s' = step s a)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 145 </font></span>        <font color="#006699"><strong>using</strong></font> enabled0 <font color="#006699"><strong>by</strong></font> simp
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 146 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 147 </font></span>    <font color="#006699"><strong>primrec</strong></font> sources <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'e list &rArr; 'd &rArr; 's &rArr; 'd set&quot;</font> <font color="#009966"><strong>where</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 148 </font></span>      sources_Nil<font color="#000000"><strong>:</strong></font><font color="#ff00cc">&quot;sources [] d s = {d}&quot;</font> <font color="#000000"><strong>|</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 149 </font></span>      sources_Cons<font color="#000000"><strong>:</strong></font><font color="#ff00cc">&quot;sources (a # as) d s = (&#8899;{sources as d (step s a)}) &cup; </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 150 </font></span><font color="#ff00cc">                              {w . w = the (domain a) &and; (&exist;v . interferes w s v &and; v&isin;sources as d (step s a))}&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 151 </font></span>    <font color="#006699"><strong>declare</strong></font> sources_Nil <font color="#000000"><strong>[</strong></font>simp del<font color="#000000"><strong>]</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 152 </font></span>    <font color="#006699"><strong>declare</strong></font> sources_Cons <font color="#000000"><strong>[</strong></font>simp del<font color="#000000"><strong>]</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 153 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 154 </font></span>    
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 155 </font></span>    
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 156 </font></span>    <font color="#006699"><strong>primrec</strong></font> ipurge <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'e list &rArr; 'd &rArr; 's  &rArr; 'e list&quot;</font> <font color="#009966"><strong>where</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 157 </font></span>      ipurge_Nil<font color="#000000"><strong>:</strong></font>   <font color="#ff00cc">&quot;ipurge [] u s = []&quot;</font> <font color="#000000"><strong>|</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 158 </font></span>      ipurge_Cons<font color="#000000"><strong>:</strong></font>  <font color="#ff00cc">&quot;ipurge (a#as) u s = (if (the (domain a) &isin; (sources (a#as) u s))</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 159 </font></span><font color="#ff00cc">                                          then</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 160 </font></span><font color="#ff00cc">                                              a # ipurge as u (step s a)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 161 </font></span><font color="#ff00cc">                                          else</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 162 </font></span><font color="#ff00cc">                                              ipurge as u (step s a)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 163 </font></span><font color="#ff00cc">                                          )&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 164 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 165 </font></span>     <font color="#006699"><strong>definition</strong></font> observ_equivalence <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'s &rArr; 'e list &rArr; 's &rArr; </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 166 </font></span><font color="#ff00cc">          'e list &rArr; 'd &rArr; bool&quot;</font> <font color="#000000"><strong>(</strong></font><font color="#ff00cc">&quot;(_ &#8882; _ &cong; _ &#8882; _ @ _)&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 167 </font></span>      <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;observ_equivalence s as t bs d &equiv; </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 168 </font></span><font color="#ff00cc">               ((run s as) &sim; d &sim; (run t bs))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 169 </font></span>     <font color="#006699"><strong>declare</strong></font> observ_equivalence_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 170 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 171 </font></span>     <font color="#006699"><strong>lemma</strong></font> observ_equiv_sym<font color="#000000"><strong>:</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 172 </font></span>       <font color="#ff00cc">&quot;(s &#8882; as &cong; t &#8882; bs @ d) &#10233; (t &#8882; bs &cong; s &#8882; as @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 173 </font></span>       <font color="#006699"><strong>using</strong></font> observ_equivalence_def vpeq_symmetric_lemma <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 174 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 175 </font></span>     <font color="#006699"><strong>lemma</strong></font> observ_equiv_trans<font color="#000000"><strong>:</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 176 </font></span>      <font color="#ff00cc">&quot;&#10214;reachable0 t; (s &#8882; as &cong; t &#8882; bs @ d); (t &#8882; bs &cong; x &#8882; cs @ d)&#10215; &#10233; (s &#8882; as &cong; x &#8882; cs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 177 </font></span>        <font color="#006699"><strong>using</strong></font> observ_equivalence_def vpeq_transitive_lemma <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 178 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 179 </font></span>     <font color="#006699"><strong>definition</strong></font> noninterference_r <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;bool&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 180 </font></span>      <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;noninterference_r &equiv; &forall;d as s. reachable0 s &#10230; (s &#8882; as &cong; s &#8882; (ipurge as d s) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 181 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 182 </font></span>     <font color="#006699"><strong>definition</strong></font> noninterference <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;bool&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 183 </font></span>      <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;noninterference &equiv; &forall;d as. (s0 &#8882; as &cong; s0 &#8882; (ipurge as d s0) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 184 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 185 </font></span>     <font color="#006699"><strong>definition</strong></font> weak_noninterference <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;bool&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 186 </font></span>      <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;weak_noninterference &equiv; &forall;d as bs. ipurge as d s0 = ipurge bs d s0</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 187 </font></span><font color="#ff00cc">                                                  &#10230; (s0 &#8882; as &cong; s0 &#8882; bs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 188 </font></span>   
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 189 </font></span>     <font color="#006699"><strong>definition</strong></font> weak_noninterference_r <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;bool&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 190 </font></span>      <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;weak_noninterference_r &equiv; &forall;d as bs s. reachable0 s &and; ipurge as d s = ipurge bs d s</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 191 </font></span><font color="#ff00cc">                                                  &#10230; (s &#8882; as &cong; s &#8882; bs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 192 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 193 </font></span>     <font color="#006699"><strong>definition</strong></font> noninfluence<font color="#000000"><strong>::</strong></font><font color="#ff00cc">&quot;bool&quot;</font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 194 </font></span>       <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;noninfluence &equiv; &forall; d as s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 195 </font></span><font color="#ff00cc">                                &and; (s &asymp; (sources as d s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 196 </font></span><font color="#ff00cc">                                &#10230; (s &#8882; as &cong; t &#8882; (ipurge as d t) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 197 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 198 </font></span>    <font color="#006699"><strong>definition</strong></font> weak_noninfluence <font color="#000000"><strong>::</strong></font><font color="#ff00cc">&quot;bool&quot;</font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 199 </font></span>      <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;weak_noninfluence &equiv; &forall; d as bs s t . reachable0 s &and; reachable0 t &and; (s &asymp; (sources as d s) &asymp; t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 200 </font></span><font color="#ff00cc">                                     &and; ipurge as d t = ipurge bs d t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 201 </font></span><font color="#ff00cc">                                     &#10230; (s &#8882; as &cong; t &#8882; bs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 202 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 203 </font></span>    <font color="#006699"><strong>definition</strong></font> weak_noninfluence2 <font color="#000000"><strong>::</strong></font><font color="#ff00cc">&quot;bool&quot;</font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 204 </font></span>      <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;weak_noninfluence2 &equiv; &forall; d as bs s t . reachable0 s &and; reachable0 t &and; (s &asymp; (sources as d s) &asymp; t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 205 </font></span><font color="#ff00cc">                                     &and; ipurge as d s = ipurge bs d t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 206 </font></span><font color="#ff00cc">                                     &#10230; (s &#8882; as &cong; t &#8882; bs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 207 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 208 </font></span>     <font color="#006699"><strong>definition</strong></font> nonleakage <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;bool&quot;</font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 209 </font></span>      <font color="#009966"><strong>where</strong></font> <font color="#ff00cc">&quot;nonleakage &equiv; &forall;d as s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 210 </font></span><font color="#ff00cc">                          &and; (s &asymp; (sources as d s) &asymp; t) &#10230; (s &#8882; as &cong; t &#8882; as @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 211 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 212 </font></span>     <font color="#006699"><strong>declare</strong></font> noninterference_r_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> noninterference_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> weak_noninterference_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 213 </font></span>        weak_noninterference_r_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> noninfluence_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 214 </font></span>        weak_noninfluence_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> weak_noninfluence2_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> nonleakage_def<font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 215 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 216 </font></span><font color="#006699"><strong>subsection</strong></font><font color="#6600cc">{* Unwinding conditions*}</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 217 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 218 </font></span>     <font color="#006699"><strong>definition</strong></font> dynamic_step_consistent <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;bool&quot;</font> <font color="#009966"><strong>where</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 219 </font></span>        <font color="#ff00cc">&quot;dynamic_step_consistent &equiv;  &forall;a d s t. reachable0 s &and; reachable0 t &and; (s &sim; d &sim; t) &and; </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 220 </font></span><font color="#ff00cc">                              (((the (domain a)) @ s &#8605; d) &#10230; (s &sim; (the (domain a)) &sim; t))</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 221 </font></span><font color="#ff00cc">                              &#10230; ((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 222 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 223 </font></span>     <font color="#006699"><strong>definition</strong></font> dynamic_weakly_step_consistent <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;bool&quot;</font> <font color="#009966"><strong>where</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 224 </font></span>        <font color="#ff00cc">&quot;dynamic_weakly_step_consistent &equiv;  &forall;a d s t. reachable0 s &and; reachable0 t &and; (s &sim; d &sim; t) &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 225 </font></span><font color="#ff00cc">                              ((the (domain a)) @ s &#8605; d) &and; (s &sim; (the (domain a)) &sim; t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 226 </font></span><font color="#ff00cc">                              &#10230; ((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 227 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 228 </font></span>     <font color="#006699"><strong>definition</strong></font> dynamic_weakly_step_consistent_e <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'e &rArr; bool&quot;</font> <font color="#009966"><strong>where</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 229 </font></span>        <font color="#ff00cc">&quot;dynamic_weakly_step_consistent_e a &equiv;  &forall;d s t. reachable0 s &and; reachable0 t &and; (s &sim; d &sim; t) &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 230 </font></span><font color="#ff00cc">                              ((the (domain a)) @ s &#8605; d) &and; (s &sim; (the (domain a)) &sim; t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 231 </font></span><font color="#ff00cc">                              &#10230; ((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 232 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 233 </font></span>     <font color="#006699"><strong>lemma</strong></font> dynamic_weakly_step_consistent_all_evt <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;dynamic_weakly_step_consistent = (&forall;a. dynamic_weakly_step_consistent_e a)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 234 </font></span>      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> dynamic_weakly_step_consistent_def dynamic_weakly_step_consistent_e_def<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 235 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 236 </font></span>     <font color="#006699"><strong>definition</strong></font> dynamic_local_respect <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;bool&quot;</font> <font color="#009966"><strong>where</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 237 </font></span>        <font color="#ff00cc">&quot;dynamic_local_respect &equiv; &forall;a d s. reachable0 s &and; &not;((the (domain a)) @ s &#8605; d) &#10230; (s &sim; d &sim; (step s a)) &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 238 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 239 </font></span>     <font color="#006699"><strong>definition</strong></font> dynamic_local_respect_e <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;'e &rArr; bool&quot;</font> <font color="#009966"><strong>where</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 240 </font></span>        <font color="#ff00cc">&quot;dynamic_local_respect_e a &equiv; &forall;d s. reachable0 s &and; &not;((the (domain a)) @ s &#8605; d) &#10230; (s &sim; d &sim; (step s a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 241 </font></span>        
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 242 </font></span>     <font color="#006699"><strong>lemma</strong></font> dynamic_local_respect_all_evt <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;dynamic_local_respect = (&forall;a. dynamic_local_respect_e a)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 243 </font></span>      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> dynamic_local_respect_def dynamic_local_respect_e_def<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 244 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 245 </font></span>     <font color="#006699"><strong>declare</strong></font> dynamic_step_consistent_def <font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> dynamic_weakly_step_consistent_def <font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font> <font color="#009966"><strong>and</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 246 </font></span>       dynamic_local_respect_def <font color="#000000"><strong>[</strong></font>cong<font color="#000000"><strong>]</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 247 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 248 </font></span>     <font color="#006699"><strong>lemma</strong></font> step_cons_impl_weak <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;dynamic_step_consistent &#10233; dynamic_weakly_step_consistent&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 249 </font></span>      <font color="#006699"><strong>using</strong></font> dynamic_step_consistent_def dynamic_weakly_step_consistent_def <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 250 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 251 </font></span>     <font color="#006699"><strong>definition</strong></font> lemma_local <font color="#000000"><strong>::</strong></font> <font color="#ff00cc">&quot;bool&quot;</font> <font color="#009966"><strong>where</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 252 </font></span>        <font color="#ff00cc">&quot;lemma_local &equiv; &forall;s a as u. the (domain a) &notin; sources (a # as) u s &#10230; (s &asymp; (sources (a # as) u s)  &asymp; (step s a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 253 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 254 </font></span>     <font color="#006699"><strong>lemma</strong></font> weak_with_step_cons<font color="#000000"><strong>:</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 255 </font></span>      <font color="#009966"><strong>assumes</strong></font> p1<font color="#000000"><strong>:</strong></font> dynamic_weakly_step_consistent
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 256 </font></span>        <font color="#009966"><strong>and</strong></font>   p2<font color="#000000"><strong>:</strong></font> dynamic_local_respect
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 257 </font></span>      <font color="#009966"><strong>shows</strong></font>   dynamic_step_consistent
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 258 </font></span>      <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 259 </font></span>      <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 260 </font></span>        <font color="#0099ff"><strong>fix</strong></font> a d s t
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 261 </font></span>        <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;reachable0 s &and; reachable0 t &and; (s &sim; d &sim; t) &and; </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 262 </font></span><font color="#ff00cc">               (((the (domain a)) @ s &#8605; d) &#10230; (s &sim; (the (domain a)) &sim; t))</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 263 </font></span><font color="#ff00cc">               &#10230; ((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 264 </font></span>          <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 265 </font></span>          <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 266 </font></span>            <font color="#0099ff"><strong>assume</strong></font> a0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 267 </font></span>            <font color="#0099ff"><strong>assume</strong></font> a1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 268 </font></span>            <font color="#0099ff"><strong>assume</strong></font> a2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &sim; d &sim; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 269 </font></span>            <font color="#0099ff"><strong>assume</strong></font> a3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(((the (domain a)) @ s &#8605; d) &#10230; (s &sim; (the (domain a)) &sim; t))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 270 </font></span>            <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 271 </font></span>              <font color="#006699"><strong>proof</strong></font> <font color="#000000"><strong>(</strong></font>cases <font color="#ff00cc">&quot;((the (domain a)) @ s &#8605; d)&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 272 </font></span>                <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((the (domain a)) @ s &#8605; d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 273 </font></span>                <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &sim; (the (domain a)) &sim; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 274 </font></span>                  <font color="#006699"><strong>using</strong></font> b0 a3 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 275 </font></span>                <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 276 </font></span>                  <font color="#006699"><strong>using</strong></font> a0 a1 a2 b0 b1 p1 dynamic_weakly_step_consistent_def <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 277 </font></span>                <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 278 </font></span>              <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 279 </font></span>                <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&not;((the (domain a)) @ s &#8605; d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 280 </font></span>                <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&not;((the (domain a)) @ t &#8605; d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 281 </font></span>                  <font color="#006699"><strong>using</strong></font> a0 a1 a2 b0 policy_respect <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 282 </font></span>                <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &sim; d &sim; (step s a)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 283 </font></span>                  <font color="#006699"><strong>using</strong></font> b0 p2 a0 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 284 </font></span>                <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;t &sim; d &sim; (step t a)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 285 </font></span>                  <font color="#006699"><strong>using</strong></font> b1 p2 a1 <font color="#006699"><strong>by</strong></font> auto  
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 286 </font></span>                <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 287 </font></span>                  <font color="#006699"><strong>using</strong></font> b2 b3 a2 vpeq_symmetric_lemma vpeq_transitive_lemma <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 288 </font></span>                <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 289 </font></span>              <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 290 </font></span>            <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 291 </font></span>          <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 292 </font></span>        <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 293 </font></span>        <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 294 </font></span>      <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 295 </font></span>    <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 296 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 297 </font></span><font color="#006699"><strong>subsection</strong></font><font color="#6600cc">{* Lemmas for the inference framework *}</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 298 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 299 </font></span>     
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 300 </font></span>     <font color="#006699"><strong>lemma</strong></font> sources_refl<font color="#000000"><strong>:</strong></font><font color="#ff00cc">&quot;reachable0 s &#10233; u &isin; sources as u s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 301 </font></span>      <font color="#006699"><strong>apply</strong></font><font color="#000000"><strong>(</strong></font>induct as arbitrary<font color="#000000"><strong>:</strong></font> s<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 302 </font></span>       <font color="#006699"><strong>apply</strong></font><font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> sources_Nil<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 303 </font></span>      <font color="#006699"><strong>apply</strong></font><font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> sources_Cons<font color="#000000"><strong>)</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 304 </font></span>      <font color="#006699"><strong>using</strong></font> enabled reachableStep  
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 305 </font></span>        <font color="#006699"><strong>by</strong></font> metis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 306 </font></span>     
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 307 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 308 </font></span>    <font color="#006699"><strong>lemma</strong></font> lemma_1_sub_1 <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;reachable0 s ;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 309 </font></span><font color="#ff00cc">                       dynamic_local_respect;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 310 </font></span><font color="#ff00cc">                       the (domain a) &notin; sources (a # as) u s;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 311 </font></span><font color="#ff00cc">                       (s &asymp; (sources (a # as) u s) &asymp; t)&#10215;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 312 </font></span><font color="#ff00cc">                      &#10233; (s &asymp; (sources as u (step s a)) &asymp; (step s a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 313 </font></span>       <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font>dynamic_local_respect_def sources_Cons<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 314 </font></span>       <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 315 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 316 </font></span>    <font color="#006699"><strong>lemma</strong></font> lemma_1_sub_2 <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;reachable0 s ;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 317 </font></span><font color="#ff00cc">                       reachable0 t ;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 318 </font></span><font color="#ff00cc">                       dynamic_local_respect;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 319 </font></span><font color="#ff00cc">                       the (domain a) &notin; sources (a # as) u s; </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 320 </font></span><font color="#ff00cc">                       (s &asymp; (sources (a # as) u s) &asymp; t)&#10215;       </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 321 </font></span><font color="#ff00cc">                      &#10233; (t &asymp; (sources as u (step s a)) &asymp; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 322 </font></span>        <font color="#006699"><strong>proof</strong></font> - 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 323 </font></span>          <font color="#0099ff"><strong>assume</strong></font> a1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 324 </font></span>          <font color="#0099ff"><strong>assume</strong></font> a2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 325 </font></span>          <font color="#0099ff"><strong>assume</strong></font> a3<font color="#000000"><strong>:</strong></font> dynamic_local_respect
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 326 </font></span>          <font color="#0099ff"><strong>assume</strong></font> a6<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain a) &notin; sources (a # as) u s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 327 </font></span>          <font color="#0099ff"><strong>assume</strong></font> a7<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources (a # as) u s) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 328 </font></span>          <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources as u (step s a) &#10230; &not;interferes (the (domain a)) s v&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 329 </font></span>            <font color="#006699"><strong>using</strong></font> a6 sources_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 330 </font></span>          <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;sources (a # as) u s = sources as u (step s a)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 331 </font></span>            <font color="#006699"><strong>using</strong></font> a6 sources_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 332 </font></span>          <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources as u (step s a) &#10230; (s &sim; v &sim; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 333 </font></span>            <font color="#006699"><strong>using</strong></font> a7 b2 ivpeq_def <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 334 </font></span>          <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources as u (step s a) &#10230; &not;interferes (the (domain a)) t v&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 335 </font></span>            <font color="#006699"><strong>using</strong></font> a1 a2 policy_respect b1 b3  <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 336 </font></span>          <font color="#006699"><strong>have</strong></font> b5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources as u (step s a) &#10230; (t &sim; v &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 337 </font></span>            <font color="#006699"><strong>using</strong></font> a2 a3 b4 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 338 </font></span>          <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 339 </font></span>            <font color="#006699"><strong>using</strong></font> ivpeq_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 340 </font></span>        <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 341 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 342 </font></span>     <font color="#006699"><strong>lemma</strong></font> lemma_1_sub_3 <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 343 </font></span><font color="#ff00cc">                       the (domain a) &notin; sources (a # as) u s;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 344 </font></span><font color="#ff00cc">                       (s &asymp; (sources (a # as) u s) &asymp; t)&#10215;     </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 345 </font></span><font color="#ff00cc">                      &#10233; (s &asymp; (sources as u (step s a)) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 346 </font></span>         <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font>sources_Cons<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 347 </font></span>         <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font>sources_Cons<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 348 </font></span>         <font color="#006699"><strong>done</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 349 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 350 </font></span>     <font color="#006699"><strong>lemma</strong></font> lemma_1_sub_4 <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;(s &asymp; (sources as u (step s a)) &asymp; t);</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 351 </font></span><font color="#ff00cc">                             (s &asymp; (sources as u (step s a)) &asymp; (step s a));</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 352 </font></span><font color="#ff00cc">                             (t &asymp; (sources as u (step s a)) &asymp; (step t a)) &#10215;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 353 </font></span><font color="#ff00cc">                      &#10233; ((step s a) &asymp;(sources as u (step s a)) &asymp; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 354 </font></span>       <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>meson ivpeq_def vpeq_symmetric_lemma vpeq_transitive_lemma<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 355 </font></span>           
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 356 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 357 </font></span>     <font color="#006699"><strong>lemma</strong></font> lemma_1 <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;reachable0 s;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 358 </font></span><font color="#ff00cc">                      reachable0 t;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 359 </font></span><font color="#ff00cc">                      dynamic_step_consistent;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 360 </font></span><font color="#ff00cc">                      dynamic_local_respect;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 361 </font></span><font color="#ff00cc">                      (s &asymp; (sources (a # as) u s) &asymp; t)&#10215;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 362 </font></span><font color="#ff00cc">                      &#10233; ((step s a) &asymp; (sources as u (step s a)) &asymp; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 363 </font></span>       <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>case_tac <font color="#ff00cc">&quot;the (domain a)&isin;sources (a # as) u s&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 364 </font></span>       <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> dynamic_step_consistent_def<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 365 </font></span>       <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> sources_Cons<font color="#000000"><strong>)</strong></font>                                                        
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 366 </font></span>         <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 367 </font></span>           <font color="#0099ff"><strong>assume</strong></font> a1<font color="#000000"><strong>:</strong></font> dynamic_local_respect
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 368 </font></span>           <font color="#0099ff"><strong>assume</strong></font> a4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain a) &notin; sources (a # as) u s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 369 </font></span>           <font color="#0099ff"><strong>assume</strong></font> a5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources (a # as) u s) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 370 </font></span>           <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 371 </font></span>           <font color="#0099ff"><strong>assume</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 372 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 373 </font></span>           <font color="#006699"><strong>have</strong></font> a6<font color="#000000"><strong>:</strong></font><font color="#ff00cc">&quot;(s &asymp; (sources as u (step s a)) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 374 </font></span>            <font color="#006699"><strong>using</strong></font> a1 policy_respect a4 a5 lemma_1_sub_3 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 375 </font></span>           <font color="#006699"><strong>then</strong></font> <font color="#006699"><strong>have</strong></font> a7<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources as u (step s a)) &asymp; (step s a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 376 </font></span>            <font color="#006699"><strong>using</strong></font> b0 a1 policy_respect a4 a5 lemma_1_sub_1 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 377 </font></span>           <font color="#006699"><strong>then</strong></font> <font color="#006699"><strong>have</strong></font> a8<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(t &asymp; (sources as u (step s a)) &asymp; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 378 </font></span>            <font color="#006699"><strong>using</strong></font> b1 b0 a1 policy_respect a4 a5 lemma_1_sub_2 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 379 </font></span>           <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> <font color="#ff00cc">&quot; ((step s a) &asymp;(sources as u (step s a)) &asymp; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 380 </font></span>            <font color="#006699"><strong>using</strong></font> a6 a7 lemma_1_sub_4 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 381 </font></span>         <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 382 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 383 </font></span>     <font color="#006699"><strong>lemma</strong></font> lemma_2 <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;reachable0 s;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 384 </font></span><font color="#ff00cc">                      dynamic_local_respect;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 385 </font></span><font color="#ff00cc">                      the (domain a) &notin; sources (a # as) u s&#10215;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 386 </font></span><font color="#ff00cc">                      &#10233; (s &asymp; (sources as u (step s a)) &asymp; (step s a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 387 </font></span>       <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font>dynamic_local_respect_def<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 388 </font></span>       <font color="#006699"><strong>apply</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font>sources_Cons<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 389 </font></span>       <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 390 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 391 </font></span>     <font color="#006699"><strong>lemma</strong></font> sources_eq1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;s t as u. reachable0 s &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 392 </font></span><font color="#ff00cc">                    reachable0 t &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 393 </font></span><font color="#ff00cc">                    dynamic_step_consistent &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 394 </font></span><font color="#ff00cc">                    dynamic_local_respect &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 395 </font></span><font color="#ff00cc">                    (s &asymp; (sources as u s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 396 </font></span><font color="#ff00cc">                    &#10230; (sources as u s) = (sources as u t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 397 </font></span>       <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 398 </font></span>       <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 399 </font></span>        <font color="#0099ff"><strong>fix</strong></font> as
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 400 </font></span>        <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;&forall;s t u. reachable0 s &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 401 </font></span><font color="#ff00cc">                    reachable0 t &and;                     </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 402 </font></span><font color="#ff00cc">                    dynamic_step_consistent &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 403 </font></span><font color="#ff00cc">                    dynamic_local_respect &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 404 </font></span><font color="#ff00cc">                    (s &asymp; (sources as u s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 405 </font></span><font color="#ff00cc">                    &#10230; (sources as u s) = (sources as u t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 406 </font></span>          <font color="#006699"><strong>proof</strong></font><font color="#000000"><strong>(</strong></font>induct as<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 407 </font></span>            <font color="#0099ff"><strong>case</strong></font> Nil <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?case <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> sources_Nil<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 408 </font></span>          <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 409 </font></span>            <font color="#0099ff"><strong>case</strong></font> <font color="#000000"><strong>(</strong></font>Cons b bs<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 410 </font></span>            <font color="#0099ff"><strong>assume</strong></font> p0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;s t u.((reachable0 s) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 411 </font></span><font color="#ff00cc">                                &and; (reachable0 t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 412 </font></span><font color="#ff00cc">                                &and; dynamic_step_consistent </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 413 </font></span><font color="#ff00cc">                                &and; dynamic_local_respect </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 414 </font></span><font color="#ff00cc">                                &and; (s &asymp; (sources bs u s) &asymp; t)) &#10230;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 415 </font></span><font color="#ff00cc">                                  (sources bs u s) = (sources bs u t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 416 </font></span>            <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?case
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 417 </font></span>              <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 418 </font></span>              <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 419 </font></span>                 <font color="#0099ff"><strong>fix</strong></font> s t u
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 420 </font></span>                 <font color="#0099ff"><strong>assume</strong></font> p1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 421 </font></span>                 <font color="#0099ff"><strong>assume</strong></font> p2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 422 </font></span>                 <font color="#0099ff"><strong>assume</strong></font> p3<font color="#000000"><strong>:</strong></font> dynamic_step_consistent
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 423 </font></span>                 <font color="#0099ff"><strong>assume</strong></font> p5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;dynamic_local_respect&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 424 </font></span>                 <font color="#0099ff"><strong>assume</strong></font> p9<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources (b # bs) u s) &asymp; t)&quot;</font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 425 </font></span>                 <font color="#006699"><strong>have</strong></font> a2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s b) &asymp; (sources bs u (step s b)) &asymp; (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 426 </font></span>                   <font color="#006699"><strong>using</strong></font> lemma_1 p1 p2 p3 policy_respect p5 p9 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 427 </font></span>                 <font color="#006699"><strong>have</strong></font> a3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;sources (b # bs) u s = sources (b # bs) u t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 428 </font></span>                   <font color="#006699"><strong>proof</strong></font> <font color="#000000"><strong>(</strong></font>cases <font color="#ff00cc">&quot;the (domain b) &isin; (sources (b # bs) u s)&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 429 </font></span>                     <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &isin; (sources (b # bs) u s)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 430 </font></span>                     <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &sim; (the(domain b)) &sim; t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 431 </font></span>                       <font color="#006699"><strong>using</strong></font> b0 p9 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 432 </font></span>                     <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;interferes (the (domain b)) s u = interferes (the (domain b)) t u &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 433 </font></span>                       <font color="#006699"><strong>using</strong></font> p1 p2 policy_respect p9 sources_refl <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 434 </font></span>                     <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(sources bs u (step s b)) = (sources bs u (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 435 </font></span>                       <font color="#006699"><strong>using</strong></font> a2 p0 p1 p2 p3 p5 reachableStep <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 436 </font></span>                     <font color="#006699"><strong>have</strong></font> b5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources bs u (step s b) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 437 </font></span><font color="#ff00cc">                          &#10230; interferes (the (domain b)) s v = interferes (the (domain b)) t v &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 438 </font></span>                       <font color="#006699"><strong>using</strong></font> p1 p2 ivpeq_def policy_respect p9 sources_Cons <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 439 </font></span>                     <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> <font color="#ff00cc">&quot;sources (b # bs) u s = sources (b # bs) u t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 440 </font></span>                       <font color="#006699"><strong>using</strong></font> b4 b5 sources_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 441 </font></span>                   <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 442 </font></span>                     <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &notin; (sources (b # bs) u s)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 443 </font></span>                     <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;sources (b # bs) u s = sources bs u (step s b)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 444 </font></span>                       <font color="#006699"><strong>using</strong></font> b0 sources_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 445 </font></span>                     <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(sources bs u (step s b)) = (sources bs u (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 446 </font></span>                       <font color="#006699"><strong>using</strong></font> a2 p0 p1 p2 p3 p5 reachableStep <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 447 </font></span>                     <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources bs u (step s b)&#10230;&not; interferes (the (domain b)) s v &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 448 </font></span>                       <font color="#006699"><strong>using</strong></font> b0 sources_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 449 </font></span>                     <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources bs u (step s b)&#10230;&not; interferes (the (domain b)) t v &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 450 </font></span>                       <font color="#006699"><strong>using</strong></font> b1 b3 p1 p2 p9 policy_respect <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 451 </font></span>                     <font color="#006699"><strong>have</strong></font> b5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources bs u (step t b)&#10230;&not; interferes (the (domain b)) t v &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 452 </font></span>                       <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> b2 b4<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 453 </font></span>                     <font color="#006699"><strong>have</strong></font> b6<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &notin; (sources (b # bs) u t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 454 </font></span>                       <font color="#006699"><strong>using</strong></font> b0 b2 b5 sources.simps<font color="#000000"><strong>(</strong></font>2<font color="#000000"><strong>)</strong></font> <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 455 </font></span>                     <font color="#006699"><strong>have</strong></font> b7<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;sources (b # bs) u t = sources bs u (step t b)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 456 </font></span>                       <font color="#006699"><strong>using</strong></font> b6 sources_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 457 </font></span>                     <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 458 </font></span>                       <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> b1 b2<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 459 </font></span>                   <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 460 </font></span>              <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 461 </font></span>              <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 462 </font></span>              <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 463 </font></span>          <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 464 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 465 </font></span>       <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 466 </font></span>       <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 467 </font></span>       <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 468 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 469 </font></span>    <font color="#006699"><strong>lemma</strong></font> ipurge_eq<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;s t as u. reachable0 s &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 470 </font></span><font color="#ff00cc">                    reachable0 t &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 471 </font></span><font color="#ff00cc">                    dynamic_step_consistent &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 472 </font></span><font color="#ff00cc">                    dynamic_local_respect &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 473 </font></span><font color="#ff00cc">                    (s &asymp; (sources as u s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 474 </font></span><font color="#ff00cc">                    &#10230; (ipurge as u s) = (ipurge as u t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 475 </font></span>       <font color="#006699"><strong>proof</strong></font> -                                               
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 476 </font></span>       <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 477 </font></span>        <font color="#0099ff"><strong>fix</strong></font> as
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 478 </font></span>        <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;&forall;s t u. reachable0 s &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 479 </font></span><font color="#ff00cc">                    reachable0 t &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 480 </font></span><font color="#ff00cc">                    dynamic_step_consistent &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 481 </font></span><font color="#ff00cc">                    dynamic_local_respect &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 482 </font></span><font color="#ff00cc">                    (s &asymp; (sources as u s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 483 </font></span><font color="#ff00cc">                    &#10230; (ipurge as u s) = (ipurge as u t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 484 </font></span>          <font color="#006699"><strong>proof</strong></font><font color="#000000"><strong>(</strong></font>induct as<font color="#000000"><strong>)</strong></font>                                         
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 485 </font></span>            <font color="#0099ff"><strong>case</strong></font> Nil <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?case <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>simp add<font color="#000000"><strong>:</strong></font> sources_Nil<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 486 </font></span>          <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 487 </font></span>            <font color="#0099ff"><strong>case</strong></font> <font color="#000000"><strong>(</strong></font>Cons b bs<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 488 </font></span>            <font color="#0099ff"><strong>assume</strong></font> p0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;s t u.((reachable0 s) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 489 </font></span><font color="#ff00cc">                                &and; (reachable0 t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 490 </font></span><font color="#ff00cc">                                &and; dynamic_step_consistent </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 491 </font></span><font color="#ff00cc">                                &and; dynamic_local_respect </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 492 </font></span><font color="#ff00cc">                                &and; (s &asymp; (sources bs u s) &asymp; t))</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 493 </font></span><font color="#ff00cc">                                &#10230; (ipurge bs u s) = (ipurge bs u t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 494 </font></span>            <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?case
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 495 </font></span>              <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 496 </font></span>              <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 497 </font></span>                 <font color="#0099ff"><strong>fix</strong></font> s t u
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 498 </font></span>                 <font color="#0099ff"><strong>assume</strong></font> p1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 499 </font></span>                 <font color="#0099ff"><strong>assume</strong></font> p2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 500 </font></span>                 <font color="#0099ff"><strong>assume</strong></font> p3<font color="#000000"><strong>:</strong></font> dynamic_step_consistent
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 501 </font></span>                 <font color="#0099ff"><strong>assume</strong></font> p5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;dynamic_local_respect&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 502 </font></span>                 <font color="#0099ff"><strong>assume</strong></font> p9<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources (b # bs) u s) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 503 </font></span>                 <font color="#006699"><strong>have</strong></font> a1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s b) &asymp; (sources bs u (step s b)) &asymp; (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 504 </font></span>                   <font color="#006699"><strong>using</strong></font> lemma_1 p1 p2 p3 p5 p9 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 505 </font></span>                 <font color="#006699"><strong>have</strong></font> a2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(ipurge bs u (step s b)) = (ipurge bs u (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 506 </font></span>                   <font color="#006699"><strong>using</strong></font> a1 p0 p1 p2 p3 p5 p9 reachableStep <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 507 </font></span>                 <font color="#006699"><strong>have</strong></font> a3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;sources (b # bs) u s = sources (b # bs) u t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 508 </font></span>                   <font color="#006699"><strong>using</strong></font> p1 p2 p3 p5 p9 sources_eq1 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 509 </font></span>                 <font color="#006699"><strong>have</strong></font> a4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;ipurge (b # bs) u s = ipurge (b # bs) u t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 510 </font></span>                   <font color="#006699"><strong>proof</strong></font> <font color="#000000"><strong>(</strong></font>cases <font color="#ff00cc">&quot;the (domain b) &isin; (sources (b # bs) u s)&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 511 </font></span>                     <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &isin; (sources (b # bs) u s)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 512 </font></span>                     <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &sim; (the(domain b)) &sim; t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 513 </font></span>                       <font color="#006699"><strong>using</strong></font> b0 p9 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 514 </font></span>                     <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &isin; (sources (b # bs) u t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 515 </font></span>                       <font color="#006699"><strong>using</strong></font> a3 b0 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 516 </font></span>                     <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 517 </font></span>                       <font color="#006699"><strong>using</strong></font> a2 b0 ipurge_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 518 </font></span>                   <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 519 </font></span>                     <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &notin; (sources (b # bs) u s)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 520 </font></span>                     <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;sources (b # bs) u s = sources bs u (step s b)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 521 </font></span>                       <font color="#006699"><strong>using</strong></font> b0 sources_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 522 </font></span>                     <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources bs u (step s b)&#10230;&not; interferes (the (domain b)) s v &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 523 </font></span>                       <font color="#006699"><strong>using</strong></font> b0 sources_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 524 </font></span>                     <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources bs u (step s b)&#10230;&not; interferes (the (domain b)) t v &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 525 </font></span>                       <font color="#006699"><strong>using</strong></font> b1 b3 p1 p2 p9 policy_respect <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 526 </font></span>                     <font color="#006699"><strong>have</strong></font> b5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &notin; (sources (b # bs) u t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 527 </font></span>                       <font color="#006699"><strong>using</strong></font> a3 b1 b4 interf_reflexive <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 528 </font></span>                     <font color="#006699"><strong>have</strong></font> b6<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;ipurge (b # bs) u s = ipurge bs u (step s b)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 529 </font></span>                       <font color="#006699"><strong>using</strong></font> b0 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 530 </font></span>                     <font color="#006699"><strong>have</strong></font> b7<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;ipurge (b # bs) u t = ipurge bs u (step t b)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 531 </font></span>                       <font color="#006699"><strong>using</strong></font> b5 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 532 </font></span>                     <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 533 </font></span>                       <font color="#006699"><strong>using</strong></font> b6 b7 a2 <font color="#006699"><strong>by</strong></font> auto 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 534 </font></span>                   <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 535 </font></span>              <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 536 </font></span>              <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 537 </font></span>              <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 538 </font></span>          <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 539 </font></span>       <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 540 </font></span>       <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 541 </font></span>       <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 542 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 543 </font></span>    <font color="#006699"><strong>lemma</strong></font> non_influgence_lemma<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;s t as u. reachable0 s &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 544 </font></span><font color="#ff00cc">                    reachable0 t &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 545 </font></span><font color="#ff00cc">                    dynamic_step_consistent &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 546 </font></span><font color="#ff00cc">                    dynamic_local_respect &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 547 </font></span><font color="#ff00cc">                    (s &asymp; (sources as u s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 548 </font></span><font color="#ff00cc">                    &#10230; ((s &#8882; as &cong; t &#8882; (ipurge as u t) @ u))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 549 </font></span>      <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 550 </font></span>      <font color="#006699"><strong>{</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 551 </font></span>        <font color="#0099ff"><strong>fix</strong></font> as
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 552 </font></span>        <font color="#006699"><strong>have</strong></font>  <font color="#ff00cc">&quot;&forall;s t u. reachable0 s &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 553 </font></span><font color="#ff00cc">                    reachable0 t &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 554 </font></span><font color="#ff00cc">                    dynamic_step_consistent &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 555 </font></span><font color="#ff00cc">                    dynamic_local_respect &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 556 </font></span><font color="#ff00cc">                    (s &asymp; (sources as u s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 557 </font></span><font color="#ff00cc">                    &#10230; ((s &#8882; as &cong; t &#8882; (ipurge as u t) @ u))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 558 </font></span>          <font color="#006699"><strong>proof</strong></font> <font color="#000000"><strong>(</strong></font>induct as<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 559 </font></span>            <font color="#0099ff"><strong>case</strong></font> Nil <font color="#0099ff"><strong>show</strong></font> ?case <font color="#006699"><strong>using</strong></font> sources_Nil <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 560 </font></span>          <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 561 </font></span>            <font color="#0099ff"><strong>case</strong></font> <font color="#000000"><strong>(</strong></font>Cons b bs<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 562 </font></span>            <font color="#0099ff"><strong>assume</strong></font> p0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;s t u.((reachable0 s) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 563 </font></span><font color="#ff00cc">                                &and; (reachable0 t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 564 </font></span><font color="#ff00cc">                                &and; dynamic_step_consistent </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 565 </font></span><font color="#ff00cc">                                &and; dynamic_local_respect </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 566 </font></span><font color="#ff00cc">                                &and; (s &asymp; (sources bs u s) &asymp; t)) &#10230;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 567 </font></span><font color="#ff00cc">                                  ((s &#8882; bs &cong; t &#8882; (ipurge bs u t) @ u))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 568 </font></span>            <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?case
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 569 </font></span>              <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 570 </font></span>              <font color="#006699"><strong>{</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 571 </font></span>                <font color="#0099ff"><strong>fix</strong></font> s t u
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 572 </font></span>                <font color="#0099ff"><strong>assume</strong></font> p1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 573 </font></span>                <font color="#0099ff"><strong>assume</strong></font> p2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 574 </font></span>                <font color="#0099ff"><strong>assume</strong></font> p3<font color="#000000"><strong>:</strong></font> dynamic_step_consistent
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 575 </font></span>                <font color="#0099ff"><strong>assume</strong></font> p4<font color="#000000"><strong>:</strong></font> dynamic_local_respect
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 576 </font></span>                <font color="#0099ff"><strong>assume</strong></font> p8<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources (b # bs) u s) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 577 </font></span>                <font color="#006699"><strong>have</strong></font> a1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s b) &asymp; (sources bs u (step s b)) &asymp; (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 578 </font></span>                  <font color="#006699"><strong>using</strong></font> lemma_1 p1 p2 p3 p4 p8 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 579 </font></span>                <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;s &#8882; b # bs &cong; t &#8882; ipurge (b # bs) u t @ u&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 580 </font></span>                  <font color="#006699"><strong>proof</strong></font> <font color="#000000"><strong>(</strong></font>cases <font color="#ff00cc">&quot;the (domain b) &isin; sources (b # bs) u s&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 581 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &isin; sources (b # bs) u s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 582 </font></span>                    <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;interferes (the (domain b)) s u = interferes (the (domain b)) t u &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 583 </font></span>                      <font color="#006699"><strong>using</strong></font> p1 p2 policy_respect p8 sources_refl <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 584 </font></span>                    <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources bs u (step s b) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 585 </font></span><font color="#ff00cc">                          &#10230; interferes (the (domain b)) s v = interferes (the (domain b)) t v &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 586 </font></span>                      <font color="#006699"><strong>using</strong></font> p1 p2 ivpeq_def policy_respect p8 sources_Cons <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 587 </font></span>                    <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;ipurge (b # bs) u t = b # (ipurge bs u (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 588 </font></span>                      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis b0 ipurge_Cons p1 p2 p3 p4 p8 sources_eq1<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 589 </font></span>                    <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(((step s b) &#8882; bs &cong; (step t b) &#8882; (ipurge bs u (step t b)) @ u))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 590 </font></span>                      <font color="#006699"><strong>using</strong></font> a1 p0 p1 p2 p3 p4 reachableStep <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 591 </font></span>                    <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 592 </font></span>                      <font color="#006699"><strong>using</strong></font> b3 b4 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 593 </font></span>                  <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 594 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &notin; sources (b # bs) u s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 595 </font></span>                    <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;ipurge (b # bs) u t = (ipurge bs u (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 596 </font></span>                      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis a1 b0 ipurge_Cons ipurge_eq p1 p2 p3 p4 p8 reachableStep<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 597 </font></span>                    <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources bs u (step s b)) &asymp; (step s b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 598 </font></span>                      <font color="#006699"><strong>using</strong></font> b0 lemma_2 p1 p4 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 599 </font></span>                    <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font><font color="#ff00cc">&quot;(s &asymp; (sources bs u (step s b)) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 600 </font></span>                      <font color="#006699"><strong>using</strong></font> b0 lemma_1_sub_3 p8 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 601 </font></span>                    <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s b) &asymp; (sources bs u (step s b)) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 602 </font></span>                      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>meson b3 b2 ivpeq_def vpeq_symmetric_lemma vpeq_transitive_lemma<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 603 </font></span>                    <font color="#006699"><strong>have</strong></font> b5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(((step s b) &#8882; bs &cong; t &#8882; (ipurge bs u t) @ u))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 604 </font></span>                      <font color="#006699"><strong>using</strong></font> b4 p0 p1 p2 p3 p4 reachableStep <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 605 </font></span>                    <font color="#006699"><strong>have</strong></font> b6<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(t &asymp; (sources bs u (step s b)) &asymp; (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 606 </font></span>                      <font color="#006699"><strong>using</strong></font> p1 p2 b0 lemma_1_sub_2 p4 p8 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 607 </font></span>                    <font color="#006699"><strong>have</strong></font> b7<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;ipurge bs u t = ipurge bs u (step t b)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 608 </font></span>                      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis a1 b4 ipurge_eq p1 p2 p3 p4 reachableStep<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 609 </font></span>                    <font color="#006699"><strong>have</strong></font> b8<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(((step s b) &#8882; bs &cong; t &#8882; (ipurge bs u (step t b)) @ u))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 610 </font></span>                      <font color="#006699"><strong>using</strong></font> b5 b7 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 611 </font></span>                    <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 612 </font></span>                      <font color="#006699"><strong>using</strong></font> b1 observ_equivalence_def run_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 613 </font></span>                  <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 614 </font></span>              <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 615 </font></span>              <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 616 </font></span>              <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 617 </font></span>          <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 618 </font></span>       <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 619 </font></span>       <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 620 </font></span>       <font color="#006699"><strong>qed</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 621 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 622 </font></span><font color="#006699"><strong>subsection</strong></font><font color="#6600cc">{* Interference framework of information flow security properties *}</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 623 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 624 </font></span>    <font color="#006699"><strong>theorem</strong></font> nonintf_impl_weak<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninterference &#10233; weak_noninterference&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 625 </font></span>      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis noninterference_def observ_equiv_sym observ_equiv_trans reachable_s0 weak_noninterference_def<font color="#000000"><strong>)</strong></font>       
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 626 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 627 </font></span>    <font color="#006699"><strong>theorem</strong></font> wk_nonintf_r_impl_wk_nonintf<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;weak_noninterference_r &#10233; weak_noninterference&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 628 </font></span>      <font color="#006699"><strong>using</strong></font> reachable_s0 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 629 </font></span>  
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 630 </font></span>    <font color="#006699"><strong>theorem</strong></font> nonintf_r_impl_noninterf<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninterference_r &#10233; noninterference&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 631 </font></span>      <font color="#006699"><strong>using</strong></font> noninterference_def noninterference_r_def reachable_s0 <font color="#006699"><strong>by</strong></font> auto 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 632 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 633 </font></span>    <font color="#006699"><strong>theorem</strong></font> nonintf_r_impl_wk_nonintf_r<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninterference_r &#10233; weak_noninterference_r&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 634 </font></span>      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis noninterference_r_def observ_equiv_sym observ_equiv_trans weak_noninterference_r_def<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 635 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 636 </font></span>    <font color="#006699"><strong>lemma</strong></font> noninf_impl_nonintf_r<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninfluence &#10233; noninterference_r&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 637 </font></span>      <font color="#006699"><strong>using</strong></font> ivpeq_def noninfluence_def noninterference_r_def vpeq_reflexive_lemma <font color="#006699"><strong>by</strong></font> blast      
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 638 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 639 </font></span>    <font color="#006699"><strong>lemma</strong></font> noninf_impl_nonlk<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninfluence &#10233; nonleakage&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 640 </font></span>      <font color="#006699"><strong>using</strong></font> noninterference_r_def nonleakage_def observ_equiv_sym 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 641 </font></span>      observ_equiv_trans noninfluence_def noninf_impl_nonintf_r <font color="#006699"><strong>by</strong></font> blast 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 642 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 643 </font></span>    <font color="#006699"><strong>lemma</strong></font> wk_noninfl_impl_nonlk<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;weak_noninfluence &#10233; nonleakage&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 644 </font></span>      <font color="#006699"><strong>using</strong></font> weak_noninfluence_def nonleakage_def <font color="#006699"><strong>by</strong></font> blast       
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 645 </font></span>    
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 646 </font></span>    <font color="#006699"><strong>lemma</strong></font> wk_noninfl_impl_wk_nonintf_r<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;weak_noninfluence &#10233; weak_noninterference_r&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 647 </font></span>      <font color="#006699"><strong>using</strong></font> ivpeq_def weak_noninfluence_def vpeq_reflexive_lemma weak_noninterference_r_def <font color="#006699"><strong>by</strong></font> blast 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 648 </font></span>  
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 649 </font></span>    <font color="#006699"><strong>lemma</strong></font> sources_step2<font color="#000000"><strong>:</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 650 </font></span>      <font color="#ff00cc">&quot;&#10214;reachable0 s; (the (domain a))@s &#8605; d&#10215; &#10233; sources [a] d s = {the (domain a),d}&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 651 </font></span>      <font color="#006699"><strong>apply</strong></font><font color="#000000"><strong>(</strong></font>auto simp<font color="#000000"><strong>:</strong></font> sources_Cons sources_Nil enabled dest<font color="#000000"><strong>:</strong></font> enabled<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 652 </font></span>      <font color="#006699"><strong>done</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 653 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 654 </font></span>    <font color="#006699"><strong>lemma</strong></font> exec_equiv_both<font color="#000000"><strong>:</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 655 </font></span>     <font color="#ff00cc">&quot;&#10214;reachable0 C1; reachable0 C2;(step C1 a) &#8882; as &cong; (step C2 b) &#8882; bs @ u&#10215; </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 656 </font></span><font color="#ff00cc">      &#10233; (C1 &#8882; (a # as) &cong; C2 &#8882; (b # bs) @ u)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 657 </font></span>        <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 658 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 659 </font></span>    <font color="#006699"><strong>lemma</strong></font> sources_unwinding_step<font color="#000000"><strong>:</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 660 </font></span>      <font color="#ff00cc">&quot;&#10214;reachable0 s; reachable0 t;s &asymp;(sources (a#as) d s)&asymp; t; dynamic_step_consistent&#10215;  </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 661 </font></span><font color="#ff00cc">        &#10233; ((step s a) &asymp;(sources as d (step s a))&asymp; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 662 </font></span>       <font color="#006699"><strong>apply</strong></font><font color="#000000"><strong>(</strong></font>clarsimp simp<font color="#000000"><strong>:</strong></font> ivpeq_def sources_Cons<font color="#000000"><strong>)</strong></font>        
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 663 </font></span>        <font color="#006699"><strong>using</strong></font> UnionI dynamic_step_consistent_def <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 664 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 665 </font></span>    <font color="#006699"><strong>lemma</strong></font> nonlk_imp_sc<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;nonleakage &#10233; dynamic_step_consistent&quot;</font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 666 </font></span>      <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 667 </font></span>        <font color="#0099ff"><strong>assume</strong></font> p0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;nonleakage&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 668 </font></span>        <font color="#006699"><strong>have</strong></font> p1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;as d s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 669 </font></span><font color="#ff00cc">                  &and; (s &asymp; (sources as d s) &asymp; t) &#10230; (s &#8882; as &cong; t &#8882; as @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 670 </font></span>          <font color="#006699"><strong>using</strong></font> p0 nonleakage_def <font color="#006699"><strong>by</strong></font> auto           
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 671 </font></span>        <font color="#006699"><strong>have</strong></font> p2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;a d s t. reachable0 s &and; reachable0 t &and; (s &sim; d &sim; t) &and; </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 672 </font></span><font color="#ff00cc">                 (((the (domain a)) @ s &#8605; d) &#10230; (s &sim; (the (domain a)) &sim; t))</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 673 </font></span><font color="#ff00cc">                 &#10230; ((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 674 </font></span>          <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 675 </font></span>          <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 676 </font></span>            <font color="#0099ff"><strong>fix</strong></font> a d s t
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 677 </font></span>            <font color="#0099ff"><strong>assume</strong></font> a0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s &and; reachable0 t &and; (s &sim; d &sim; t) &and; </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 678 </font></span><font color="#ff00cc">                 (((the (domain a)) @ s &#8605; d) &#10230; (s &sim; (the (domain a)) &sim; t))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 679 </font></span>            <font color="#006699"><strong>have</strong></font> a4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &asymp; (sources [] d s) &asymp; t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 680 </font></span>              <font color="#006699"><strong>using</strong></font> a0 sources_Nil <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 681 </font></span>            <font color="#006699"><strong>have</strong></font> a5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &#8882; [] &cong; t &#8882; [] @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 682 </font></span>              <font color="#006699"><strong>using</strong></font> a4 a0 p1 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 683 </font></span>            <font color="#006699"><strong>have</strong></font> a6<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 684 </font></span>            <font color="#006699"><strong>proof</strong></font> <font color="#000000"><strong>(</strong></font>cases <font color="#ff00cc">&quot;(the (domain a))@s &#8605; d&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 685 </font></span>              <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(the (domain a))@s &#8605; d&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 686 </font></span>              <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;sources [a] d s = {d, (the(domain a))}&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 687 </font></span>                <font color="#006699"><strong>using</strong></font> b0 sources_Cons sources_Nil <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 688 </font></span>              <font color="#006699"><strong>have</strong></font> c0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &sim; (the (domain a)) &sim; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 689 </font></span>                <font color="#006699"><strong>using</strong></font> b0 a0 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 690 </font></span>              <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &asymp; (sources [a] d s) &asymp; t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 691 </font></span>                <font color="#006699"><strong>using</strong></font> b1 a0 c0 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 692 </font></span>              <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &#8882; [a] &cong; t &#8882; [a] @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 693 </font></span>                <font color="#006699"><strong>using</strong></font> b2 a0 p1 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 694 </font></span>              <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 695 </font></span>                <font color="#006699"><strong>using</strong></font> b3 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 696 </font></span>              <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 697 </font></span>            <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 698 </font></span>              <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&not;((the (domain a))@s &#8605; d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 699 </font></span>              <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;sources [a] d s = {d}&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 700 </font></span>                <font color="#006699"><strong>using</strong></font> b0 sources_Cons sources_Nil <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 701 </font></span>              <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources [a] d s) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 702 </font></span>                <font color="#006699"><strong>using</strong></font> b1 a0 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 703 </font></span>              <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &#8882; [a] &cong; t &#8882; [a] @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 704 </font></span>                <font color="#006699"><strong>using</strong></font> b2 a0 p1 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 705 </font></span>              <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 706 </font></span>                <font color="#006699"><strong>using</strong></font> b3 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 707 </font></span>              <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 708 </font></span>            <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 709 </font></span>            <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 710 </font></span>          <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 711 </font></span>            <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 712 </font></span>        <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 713 </font></span>      <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 714 </font></span>    <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 715 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 716 </font></span>    <font color="#006699"><strong>lemma</strong></font> sc_imp_nonlk<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;dynamic_step_consistent &#10233; nonleakage&quot;</font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 717 </font></span>      <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 718 </font></span>        <font color="#0099ff"><strong>assume</strong></font> p0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;dynamic_step_consistent&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 719 </font></span>        <font color="#006699"><strong>have</strong></font> p1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;a d s t. reachable0 s &and; reachable0 t &and; (s &sim; d &sim; t) &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 720 </font></span><font color="#ff00cc">               (s &sim; (the (domain a)) &sim; t) &#10230; ((step s a) &sim; d &sim; (step t a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 721 </font></span>          <font color="#006699"><strong>using</strong></font> p0 dynamic_step_consistent_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 722 </font></span>        <font color="#006699"><strong>have</strong></font> p2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;as d s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 723 </font></span><font color="#ff00cc">                  &and; (s &asymp; (sources as d s) &asymp; t) &#10230; (s &#8882; as &cong; t &#8882; as @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 724 </font></span>          <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 725 </font></span>          <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 726 </font></span>            <font color="#0099ff"><strong>fix</strong></font> as
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 727 </font></span>            <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;&forall;d s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 728 </font></span><font color="#ff00cc">                  &and; (s &asymp; (sources as d s) &asymp; t) &#10230; (s &#8882; as &cong; t &#8882; as @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 729 </font></span>              <font color="#006699"><strong>proof</strong></font> <font color="#000000"><strong>(</strong></font>induct as<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 730 </font></span>                <font color="#0099ff"><strong>case</strong></font> Nil <font color="#0099ff"><strong>show</strong></font> ?case <font color="#006699"><strong>using</strong></font> sources_refl <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 731 </font></span>              <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 732 </font></span>                <font color="#0099ff"><strong>case</strong></font> <font color="#000000"><strong>(</strong></font>Cons b bs<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 733 </font></span>                <font color="#0099ff"><strong>assume</strong></font> a0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;d s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 734 </font></span><font color="#ff00cc">                  &and; (s &asymp; (sources bs d s) &asymp; t) &#10230; (s &#8882; bs &cong; t &#8882; bs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 735 </font></span>                <font color="#0099ff"><strong>show</strong></font> ?case
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 736 </font></span>                  <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 737 </font></span>                  <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 738 </font></span>                    <font color="#0099ff"><strong>fix</strong></font> d s t
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 739 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s &and; reachable0 t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 740 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources (b#bs) d s) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 741 </font></span>                    <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s b) &asymp;(sources bs d (step s b))&asymp; (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 742 </font></span>                      <font color="#006699"><strong>using</strong></font> b0 b1 p0 sources_unwinding_step <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 743 </font></span>                    <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(step s b) &#8882; bs &cong; (step t b) &#8882; bs @ d&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 744 </font></span>                      <font color="#006699"><strong>using</strong></font> Cons.hyps b0 b2 reachableStep <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 745 </font></span>                    <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &#8882; b # bs &cong; t &#8882; b # bs @ d&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 746 </font></span>                      <font color="#006699"><strong>using</strong></font> b3 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 747 </font></span>                    <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 748 </font></span>                    <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 749 </font></span>                <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 750 </font></span>              <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 751 </font></span>            <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 752 </font></span>          <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 753 </font></span>        <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 754 </font></span>      <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 755 </font></span>    <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 756 </font></span>          
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 757 </font></span>    <font color="#006699"><strong>theorem</strong></font> sc_eq_nonlk<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;dynamic_step_consistent = nonleakage&quot;</font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 758 </font></span>      <font color="#006699"><strong>using</strong></font> nonlk_imp_sc sc_imp_nonlk <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 759 </font></span>    
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 760 </font></span>    <font color="#006699"><strong>lemma</strong></font> noninf_imp_dlr<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninfluence &#10233; dynamic_local_respect&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 761 </font></span>      <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 762 </font></span>        <font color="#0099ff"><strong>assume</strong></font> p0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninfluence&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 763 </font></span>        <font color="#006699"><strong>have</strong></font> p1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall; d as s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 764 </font></span><font color="#ff00cc">                  &and; (s &asymp; (sources as d s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 765 </font></span><font color="#ff00cc">                  &#10230; (s &#8882; as &cong; t &#8882; (ipurge as d t) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 766 </font></span>          <font color="#006699"><strong>using</strong></font> p0 noninfluence_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 767 </font></span>        <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;&forall;a d s. reachable0 s &and; &not;((the (domain a)) @ s &#8605; d) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 768 </font></span><font color="#ff00cc">                    &#10230; (s &sim; d &sim; (step s a)) &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 769 </font></span>          <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 770 </font></span>          <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 771 </font></span>            <font color="#0099ff"><strong>fix</strong></font> a d s
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 772 </font></span>            <font color="#0099ff"><strong>assume</strong></font> a0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s &and; &not;((the (domain a)) @ s &#8605; d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 773 </font></span>            <font color="#006699"><strong>have</strong></font> a1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;sources [a] d s = {d}&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 774 </font></span>              <font color="#006699"><strong>using</strong></font> a0 sources_Cons sources_Nil <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 775 </font></span>            <font color="#006699"><strong>have</strong></font> a2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(ipurge [a] d s) = []&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 776 </font></span>              <font color="#006699"><strong>using</strong></font> a0 a1 interf_reflexive <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 777 </font></span>            <font color="#006699"><strong>have</strong></font> a3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &sim; d &sim; s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 778 </font></span>              <font color="#006699"><strong>using</strong></font> vpeq_reflexive_lemma <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 779 </font></span>            <font color="#006699"><strong>have</strong></font> a4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources [a] d s) &asymp; s)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 780 </font></span>              <font color="#006699"><strong>using</strong></font> a1 a3 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 781 </font></span>            <font color="#006699"><strong>have</strong></font> a5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &#8882; [a] &cong; s &#8882; (ipurge [a] d s) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 782 </font></span>              <font color="#006699"><strong>using</strong></font> a4 a0 p1 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 783 </font></span>            <font color="#006699"><strong>have</strong></font> a6<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &#8882; [a] &cong; s &#8882; [] @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 784 </font></span>              <font color="#006699"><strong>using</strong></font> a5 a2 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 785 </font></span>            <font color="#006699"><strong>have</strong></font> a7<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &sim; d &sim; (step s a))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 786 </font></span>              <font color="#006699"><strong>using</strong></font> a6 vpeq_symmetric_lemma <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 787 </font></span>            <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 788 </font></span>          <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 789 </font></span>        <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 790 </font></span>      <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 791 </font></span>    <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 792 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 793 </font></span>    <font color="#006699"><strong>lemma</strong></font> noninf_imp_sc<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninfluence &#10233; dynamic_step_consistent&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 794 </font></span>      <font color="#006699"><strong>using</strong></font> nonlk_imp_sc noninf_impl_nonlk <font color="#006699"><strong>by</strong></font> blast  
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 795 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 796 </font></span>    <font color="#006699"><strong>theorem</strong></font> UnwindingTheorem <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;dynamic_step_consistent;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 797 </font></span><font color="#ff00cc">                            dynamic_local_respect&#10215; </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 798 </font></span><font color="#ff00cc">                            &#10233; noninfluence&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 799 </font></span>      <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 800 </font></span>        <font color="#0099ff"><strong>assume</strong></font> p3<font color="#000000"><strong>:</strong></font> dynamic_step_consistent
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 801 </font></span>        <font color="#0099ff"><strong>assume</strong></font> p4<font color="#000000"><strong>:</strong></font> dynamic_local_respect
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 802 </font></span>        <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 803 </font></span>        <font color="#0099ff"><strong>fix</strong></font> as d
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 804 </font></span>        <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;&forall;s t. reachable0 s &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 805 </font></span><font color="#ff00cc">                  reachable0 t &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 806 </font></span><font color="#ff00cc">                  (s &asymp; (sources as d s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 807 </font></span><font color="#ff00cc">                  &#10230; ((s &#8882; as &cong; t &#8882; (ipurge as d  t) @ d))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 808 </font></span>          <font color="#006699"><strong>proof</strong></font><font color="#000000"><strong>(</strong></font>induct as<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 809 </font></span>            <font color="#0099ff"><strong>case</strong></font> Nil <font color="#0099ff"><strong>show</strong></font> ?case <font color="#006699"><strong>using</strong></font> sources_Nil <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 810 </font></span>          <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 811 </font></span>            <font color="#0099ff"><strong>case</strong></font> <font color="#000000"><strong>(</strong></font>Cons b bs<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 812 </font></span>            <font color="#0099ff"><strong>assume</strong></font> p0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;s t. reachable0 s &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 813 </font></span><font color="#ff00cc">                  reachable0 t &and;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 814 </font></span><font color="#ff00cc">                  (s &asymp; (sources bs d s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 815 </font></span><font color="#ff00cc">                  &#10230; ((s &#8882; bs &cong; t &#8882; (ipurge bs d  t) @ d))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 816 </font></span>            <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?case
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 817 </font></span>              <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 818 </font></span>              <font color="#006699"><strong>{</strong></font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 819 </font></span>                <font color="#0099ff"><strong>fix</strong></font> s t
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 820 </font></span>                <font color="#0099ff"><strong>assume</strong></font> p1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 821 </font></span>                <font color="#0099ff"><strong>assume</strong></font> p2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 822 </font></span>                <font color="#0099ff"><strong>assume</strong></font> p8<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources (b # bs) d s) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 823 </font></span>                <font color="#006699"><strong>have</strong></font> a1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s b) &asymp; (sources bs d (step s b)) &asymp; (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 824 </font></span>                  <font color="#006699"><strong>using</strong></font> lemma_1 p1 p2 p3 p4 p8 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 825 </font></span>                <font color="#006699"><strong>have</strong></font> a2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &#8882; b # bs &cong; t &#8882; ipurge (b # bs) d t @ d&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 826 </font></span>                  <font color="#006699"><strong>proof</strong></font> <font color="#000000"><strong>(</strong></font>cases <font color="#ff00cc">&quot;the (domain b) &isin; sources (b # bs) d s&quot;</font><font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 827 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &isin; sources (b # bs) d s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 828 </font></span>                    <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;interferes (the (domain b)) s d = interferes (the (domain b)) t d &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 829 </font></span>                      <font color="#006699"><strong>using</strong></font> p1 p2 policy_respect p8 sources_refl <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 830 </font></span>                    <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;v. v&isin;sources bs d (step s b) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 831 </font></span><font color="#ff00cc">                          &#10230; interferes (the (domain b)) s v = interferes (the (domain b)) t v &quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 832 </font></span>                      <font color="#006699"><strong>using</strong></font> p1 p2 ivpeq_def policy_respect p8 sources_Cons <font color="#006699"><strong>by</strong></font> fastforce
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 833 </font></span>                    <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;ipurge (b # bs) d t = b # (ipurge bs d (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 834 </font></span>                      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis b0 ipurge_Cons p1 p2 p3 p4 p8 sources_eq1<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 835 </font></span>                    <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(((step s b) &#8882; bs &cong; (step t b) &#8882; (ipurge bs d (step t b)) @ d))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 836 </font></span>                      <font color="#006699"><strong>using</strong></font> a1 p0 p1 p2 p3 p4 reachableStep <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 837 </font></span>                    <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 838 </font></span>                      <font color="#006699"><strong>using</strong></font> b3 b4 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 839 </font></span>                  <font color="#006699"><strong>next</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 840 </font></span>                    <font color="#0099ff"><strong>assume</strong></font> b0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;the (domain b) &notin; sources (b # bs) d s&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 841 </font></span>                    <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;ipurge (b # bs) d t = (ipurge bs d (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 842 </font></span>                      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis a1 b0 ipurge_Cons ipurge_eq p1 p2 p3 p4 p8 reachableStep<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 843 </font></span>                    <font color="#006699"><strong>have</strong></font> b2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &asymp; (sources bs d (step s b)) &asymp; (step s b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 844 </font></span>                      <font color="#006699"><strong>using</strong></font> b0 lemma_2 p1 p4 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 845 </font></span>                    <font color="#006699"><strong>have</strong></font> b3<font color="#000000"><strong>:</strong></font><font color="#ff00cc">&quot;(s &asymp; (sources bs d (step s b)) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 846 </font></span>                      <font color="#006699"><strong>using</strong></font> b0 lemma_1_sub_3 p8 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 847 </font></span>                    <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;((step s b) &asymp; (sources bs d (step s b)) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 848 </font></span>                      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>meson b3 b2 ivpeq_def vpeq_symmetric_lemma vpeq_transitive_lemma<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 849 </font></span>                    <font color="#006699"><strong>have</strong></font> b5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(((step s b) &#8882; bs &cong; t &#8882; (ipurge bs d t) @ d))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 850 </font></span>                      <font color="#006699"><strong>using</strong></font> b4 p0 p1 p2 p3 p4 reachableStep <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 851 </font></span>                    <font color="#006699"><strong>have</strong></font> b6<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(t &asymp; (sources bs d (step s b)) &asymp; (step t b))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 852 </font></span>                      <font color="#006699"><strong>using</strong></font> p1 p2 b0 lemma_1_sub_2 p4 p8 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 853 </font></span>                    <font color="#006699"><strong>have</strong></font> b7<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;ipurge bs d t = ipurge bs d (step t b)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 854 </font></span>                      <font color="#006699"><strong>by</strong></font> <font color="#000000"><strong>(</strong></font>metis a1 b4 ipurge_eq p1 p2 p3 p4 reachableStep<font color="#000000"><strong>)</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 855 </font></span>                    <font color="#006699"><strong>have</strong></font> b8<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(((step s b) &#8882; bs &cong; t &#8882; (ipurge bs d (step t b)) @ d))&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 856 </font></span>                      <font color="#006699"><strong>using</strong></font> b5 b7 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 857 </font></span>                    <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 858 </font></span>                      <font color="#006699"><strong>using</strong></font> b1 observ_equivalence_def run_Cons <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 859 </font></span>                  <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 860 </font></span>              <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 861 </font></span>              <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 862 </font></span>              <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 863 </font></span>          <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 864 </font></span>          <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 865 </font></span>      <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>using</strong></font> noninfluence_def <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 866 </font></span>    <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 867 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 868 </font></span>    <font color="#006699"><strong>theorem</strong></font> UnwindingTheorem1 <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;dynamic_weakly_step_consistent;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 869 </font></span><font color="#ff00cc">                            dynamic_local_respect&#10215;  &#10233; noninfluence&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 870 </font></span>      <font color="#006699"><strong>using</strong></font> UnwindingTheorem weak_with_step_cons <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 871 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 872 </font></span>   <font color="#006699"><strong>theorem</strong></font> uc_eq_noninf <font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(dynamic_step_consistent &and; dynamic_local_respect) = noninfluence&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 873 </font></span>     <font color="#006699"><strong>using</strong></font> UnwindingTheorem1 step_cons_impl_weak noninf_imp_dlr noninf_imp_sc <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 874 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 875 </font></span>   <font color="#cc0000">(*</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 876 </font></span><font color="#cc0000">     dipurge_eq required</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 877 </font></span><font color="#cc0000">   *)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 878 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 879 </font></span>   <font color="#006699"><strong>theorem</strong></font> noninf_impl_weak<font color="#000000"><strong>:</strong></font><font color="#ff00cc">&quot;noninfluence &#10233; weak_noninfluence&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 880 </font></span>     <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 881 </font></span>     <font color="#0099ff"><strong>assume</strong></font> p0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninfluence&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 882 </font></span>     <font color="#006699"><strong>have</strong></font> p1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall; d as s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 883 </font></span><font color="#ff00cc">               &and; (s &asymp; (sources as d s) &asymp; t)  </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 884 </font></span><font color="#ff00cc">               &#10230; (s &#8882; as &cong; t &#8882; (ipurge as d t) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 885 </font></span>       <font color="#006699"><strong>using</strong></font> p0 noninfluence_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 886 </font></span>     <font color="#006699"><strong>have</strong></font> p2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(dynamic_step_consistent &and; dynamic_local_respect)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 887 </font></span>       <font color="#006699"><strong>using</strong></font> p0 uc_eq_noninf <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 888 </font></span>     <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;&forall; d as bs s t . reachable0 s &and; reachable0 t &and; (s &asymp; (sources as d s) &asymp; t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 889 </font></span><font color="#ff00cc">               &and; ipurge as d t = ipurge bs d t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 890 </font></span><font color="#ff00cc">               &#10230; (s &#8882; as &cong; t &#8882; bs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 891 </font></span>       <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 892 </font></span>       <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 893 </font></span>         <font color="#0099ff"><strong>fix</strong></font> d as bs s t
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 894 </font></span>         <font color="#0099ff"><strong>assume</strong></font> a0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s &and; reachable0 t &and; (s &asymp; (sources as d s) &asymp; t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 895 </font></span><font color="#ff00cc">               &and; ipurge as d t = ipurge bs d t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 896 </font></span>         <font color="#006699"><strong>have</strong></font> a4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninterference_r&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 897 </font></span>           <font color="#006699"><strong>using</strong></font> noninf_impl_nonintf_r p0 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 898 </font></span>         <font color="#006699"><strong>have</strong></font> a7<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;weak_noninterference_r&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 899 </font></span>           <font color="#006699"><strong>using</strong></font> a4 nonintf_r_impl_wk_nonintf_r <font color="#006699"><strong>by</strong></font> auto  
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 900 </font></span>         <font color="#006699"><strong>have</strong></font> a6<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;ipurge as d s = ipurge as d t&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 901 </font></span>           <font color="#006699"><strong>using</strong></font> a0 p2 ipurge_eq <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 902 </font></span>         <font color="#006699"><strong>have</strong></font> b1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &#8882; as &cong; t &#8882; (ipurge as d t) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 903 </font></span>           <font color="#006699"><strong>using</strong></font> a0 p1 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 904 </font></span>         <font color="#006699"><strong>have</strong></font> b4<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &#8882; as &cong; t &#8882; as @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 905 </font></span>           <font color="#006699"><strong>using</strong></font> a0 noninf_imp_sc nonleakage_def p0 sc_imp_nonlk <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 906 </font></span>         <font color="#006699"><strong>have</strong></font> b5<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(t &#8882; bs &cong; t &#8882; (ipurge bs d t) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 907 </font></span>           <font color="#006699"><strong>using</strong></font> a0 a4 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 908 </font></span>         <font color="#006699"><strong>have</strong></font> b6<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(t &#8882; bs &cong; t &#8882; (ipurge as d t) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 909 </font></span>           <font color="#006699"><strong>using</strong></font> b5 a0 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 910 </font></span>         <font color="#006699"><strong>have</strong></font> b7<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &#8882; as &cong; t &#8882; bs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 911 </font></span>           <font color="#006699"><strong>using</strong></font> a0 b1 b6 observ_equiv_sym observ_equiv_trans <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 912 </font></span>         <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 913 </font></span>         <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 914 </font></span>       <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 915 </font></span>     <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 916 </font></span>   <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 917 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 918 </font></span>    
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 919 </font></span>    <font color="#006699"><strong>lemma</strong></font> wk_nonintf_r_and_nonlk_impl_noninfl<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;weak_noninterference_r; nonleakage&#10215; &#10233; weak_noninfluence&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 920 </font></span>      <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 921 </font></span>        <font color="#0099ff"><strong>assume</strong></font> p0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;weak_noninterference_r&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 922 </font></span>        <font color="#0099ff"><strong>assume</strong></font> p1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;nonleakage&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 923 </font></span>        <font color="#006699"><strong>have</strong></font> p2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;d as bs s. reachable0 s &and; ipurge as d s = ipurge bs d s</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 924 </font></span><font color="#ff00cc">                              &#10230; (s &#8882; as &cong; s &#8882; bs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 925 </font></span>          <font color="#006699"><strong>using</strong></font> weak_noninterference_r_def p0 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 926 </font></span>        <font color="#006699"><strong>have</strong></font> p3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;d as s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 927 </font></span><font color="#ff00cc">                          &and; (s &asymp; (sources as d s) &asymp; t) &#10230; (s &#8882; as &cong; t &#8882; as @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 928 </font></span>          <font color="#006699"><strong>using</strong></font> nonleakage_def p1 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 929 </font></span>        <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;&forall; d as bs s t . reachable0 s &and; reachable0 t &and; (s &asymp; (sources as d s) &asymp; t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 930 </font></span><font color="#ff00cc">                              &and; ipurge as d t = ipurge bs d t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 931 </font></span><font color="#ff00cc">                              &#10230; (s &#8882; as &cong; t &#8882; bs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 932 </font></span>          <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 933 </font></span>          <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 934 </font></span>            <font color="#0099ff"><strong>fix</strong></font> d as bs s t
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 935 </font></span>            <font color="#0099ff"><strong>assume</strong></font> a0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s &and; reachable0 t &and; (s &asymp; (sources as d s) &asymp; t) </font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 936 </font></span><font color="#ff00cc">                              &and; ipurge as d t = ipurge bs d t&quot;</font>  
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 937 </font></span>            <font color="#006699"><strong>have</strong></font> a1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &#8882; as &cong; t &#8882; as @ d&quot;</font> 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 938 </font></span>              <font color="#006699"><strong>using</strong></font> a0 p3 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 939 </font></span>            <font color="#006699"><strong>have</strong></font> a2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;t &#8882; as &cong; t &#8882; bs @ d&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 940 </font></span>              <font color="#006699"><strong>using</strong></font> a0 p2 <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 941 </font></span>            <font color="#006699"><strong>have</strong></font> a3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(s &#8882; as &cong; t &#8882; bs @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 942 </font></span>              <font color="#006699"><strong>using</strong></font> a0 a1 a2 observ_equiv_trans <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 943 </font></span>          <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 944 </font></span>          <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 945 </font></span>        <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 946 </font></span>      <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 947 </font></span>    <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 948 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 949 </font></span>    <font color="#006699"><strong>lemma</strong></font> nonintf_r_and_nonlk_impl_noninfl<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&#10214;noninterference_r; nonleakage&#10215; &#10233; noninfluence&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 950 </font></span>      <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 951 </font></span>        <font color="#0099ff"><strong>assume</strong></font> p0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;noninterference_r&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 952 </font></span>        <font color="#0099ff"><strong>assume</strong></font> p1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;nonleakage&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 953 </font></span>        <font color="#006699"><strong>have</strong></font> p2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot; &forall;d as s. reachable0 s &#10230; (s &#8882; as &cong; s &#8882; (ipurge as d s) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 954 </font></span>          <font color="#006699"><strong>using</strong></font> p0 noninterference_r_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 955 </font></span>        <font color="#006699"><strong>have</strong></font> p3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;&forall;d as s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 956 </font></span><font color="#ff00cc">                          &and; (s &asymp; (sources as d s) &asymp; t) &#10230; (s &#8882; as &cong; t &#8882; as @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 957 </font></span>          <font color="#006699"><strong>using</strong></font> p1 nonleakage_def <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 958 </font></span>        <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;&forall; d as s t. reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 959 </font></span><font color="#ff00cc">                          &and; (s &asymp; (sources as d s) &asymp; t)</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 960 </font></span><font color="#ff00cc">                          &#10230; (s &#8882; as &cong; t &#8882; (ipurge as d t) @ d)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 961 </font></span>        <font color="#006699"><strong>proof</strong></font> -
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 962 </font></span>          <font color="#006699"><strong>{</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 963 </font></span>            <font color="#0099ff"><strong>fix</strong></font> d as bs s t
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 964 </font></span>            <font color="#0099ff"><strong>assume</strong></font> a0<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;reachable0 s &and; reachable0 t</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 965 </font></span><font color="#ff00cc">                          &and; (s &asymp; (sources as d s) &asymp; t)&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 966 </font></span>            <font color="#006699"><strong>have</strong></font> a1<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &#8882; as &cong; t &#8882; as @ d&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 967 </font></span>              <font color="#006699"><strong>using</strong></font> p3 a0 <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 968 </font></span>            <font color="#006699"><strong>have</strong></font> a2<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;s &#8882; as &cong; s &#8882; (ipurge as d s) @ d&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 969 </font></span>              <font color="#006699"><strong>using</strong></font> a0 p2 <font color="#006699"><strong>by</strong></font> fast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 970 </font></span>            <font color="#006699"><strong>have</strong></font> a3<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;t &#8882; as &cong; t &#8882; (ipurge as d t) @ d&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 971 </font></span>              <font color="#006699"><strong>using</strong></font> a0 p2 <font color="#006699"><strong>by</strong></font> fast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 972 </font></span>            <font color="#006699"><strong>have</strong></font> <font color="#ff00cc">&quot;s &#8882; as &cong; t &#8882; (ipurge as d t) @ d&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 973 </font></span>              <font color="#006699"><strong>using</strong></font> a0 a1 a3 observ_equiv_trans <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 974 </font></span>            <font color="#006699"><strong>}</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 975 </font></span>          <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>by</strong></font> auto
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 976 </font></span>        <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 977 </font></span>      <font color="#006699"><strong>then</strong></font> <font color="#0099ff"><strong>show</strong></font> ?thesis <font color="#006699"><strong>using</strong></font> noninfluence_def <font color="#006699"><strong>by</strong></font> blast
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 978 </font></span>    <font color="#006699"><strong>qed</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 979 </font></span>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff990066"> 980 </font></span>    <font color="#006699"><strong>theorem</strong></font> nonintf_r_and_nonlk_eq_strnoninfl<font color="#000000"><strong>:</strong></font> <font color="#ff00cc">&quot;(noninterference_r &and; nonleakage) = noninfluence&quot;</font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 981 </font></span>      <font color="#006699"><strong>using</strong></font> nonintf_r_and_nonlk_impl_noninfl noninf_impl_nonintf_r noninf_impl_nonlk <font color="#006699"><strong>by</strong></font> blast 
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 982 </font></span>     
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 983 </font></span>  <font color="#009966"><strong>end</strong></font>
<span style="background:#ffdbdbdb; border-right:solid 2px black; margin-right:5px; "><font color="#ff000000"> 984 </font></span><font color="#009966"><strong>end</strong></font>
</font></pre>
</body>
</html>
